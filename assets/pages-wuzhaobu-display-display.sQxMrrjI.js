import{h as a,j as e,B as l,c as s,w as t,i,o as n,a as u,b as r,v as h,t as c,u as d,F as g,y as o,e as f}from"./index-B3nXFQOE.js";import{s as _,f as S,h as b,a as p}from"./sizhu.CsmR9TSq.js";import{Z as m,g as y}from"./shensha.BNxbvs-g.js";import{g as C}from"./calc.C9UNSTpI.js";import{_ as z}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./index.BHYqNsFk.js";const w={0:"å­",1:"å­",2:"ä¸‘",3:"ä¸‘",4:"å¯…",5:"å¯…",6:"å¯",7:"å¯",8:"è¾°",9:"è¾°",10:"å·³",11:"å·³",12:"åˆ",13:"åˆ",14:"æœª",15:"æœª",16:"ç”³",17:"ç”³",18:"é…‰",19:"é…‰",20:"æˆŒ",21:"æˆŒ",22:"äº¥",23:"äº¥"},L=["é’é¾™","æœ±é›€","è…¾è›‡","å‹¾é™ˆ","ç™½è™","ç„æ­¦"],D={"ç”²":0,"ä¹™":0,"ä¸™":1,"ä¸":1,"æˆŠ":3,"å·±":3,"åºš":4,"è¾›":4,"å£¬":5,"ç™¸":5},x=[[0,0],[1,0],[0,1],[1,1],[1,2],[2,1]],Z={"ç”²":"æœ¨","ä¹™":"æœ¨","å¯…":"æœ¨","å¯":"æœ¨","æœ¨":"æœ¨","ä¸™":"ç«","ä¸":"ç«","å·³":"ç«","åˆ":"ç«","ç«":"ç«","æˆŠ":"åœŸ","å·±":"åœŸ","è¾°":"åœŸ","æˆŒ":"åœŸ","ä¸‘":"åœŸ","æœª":"åœŸ","åœŸ":"åœŸ","åºš":"é‡‘","è¾›":"é‡‘","ç”³":"é‡‘","é…‰":"é‡‘","é‡‘":"é‡‘","å£¬":"æ°´","ç™¸":"æ°´","äº¥":"æ°´","å­":"æ°´","æ°´":"æ°´"},G={"æœ¨":"ç«","ç«":"åœŸ","åœŸ":"é‡‘","é‡‘":"æ°´","æ°´":"æœ¨"},W={"æœ¨":"åœŸ","åœŸ":"æ°´","æ°´":"ç«","ç«":"é‡‘","é‡‘":"æœ¨"};const E=z({data:()=>({solarDateStr:"",lunarDateStr:"",bazi:[],shenshaRows:[],inputGrid:[],liuShenGrid:[["","",""],["","",""],["","",""]],siZhuData:null}),onLoad(a){if(a.grid)try{this.inputGrid=JSON.parse(decodeURIComponent(a.grid))}catch(e){console.error("Failed to parse grid",e)}a.datetime&&(this.solarDateStr=decodeURIComponent(a.datetime)),this.initData()},methods:{goBack(){a().length>1?e():l({url:"/pages/wuzhaobu/start/start"})},initData(){let a;if(this.solarDateStr){const e=this.solarDateStr.split(" "),l=e[0].split("-"),s=e[1]?e[1].split(":"):["12","00"];a=new Date(parseInt(l[0]),parseInt(l[1])-1,parseInt(l[2]),parseInt(s[0]),parseInt(s[1]))}else{a=new Date;const e=a.getFullYear(),l=String(a.getMonth()+1).padStart(2,"0"),s=String(a.getDate()).padStart(2,"0"),t=String(a.getHours()).padStart(2,"0"),i=String(a.getMinutes()).padStart(2,"0");this.solarDateStr=`${e}-${l}-${s} ${t}:${i}`}this.calculateLunarDate(a),this.calculateBazi(a),this.calculateLiuShen(),this.calculateShenSha()},calculateLunarDate(a){try{const e=_(a);if(e){const l=String(e.year).split("").map((a=>["ã€‡","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­","ä¸ƒ","å…«","ä¹"][parseInt(a)])).join(""),s=S(e.month),t=b(e.day),i=w[a.getHours()]+"æ—¶";this.lunarDateStr=`${l}å¹´${e.isLeap?"é—°":""}${s}æœˆ${t} ${i}`}}catch(e){console.error("Lunar calculation failed:",e),this.lunarDateStr="å†œå†è®¡ç®—é”™è¯¯"}},calculateBazi(a){try{const e=p(a);console.log("SiZhu result:",e),e&&(this.siZhuData=e,this.bazi=[{gan:e.yearGan,zhi:e.yearZhi,nayin:C(e.year)},{gan:e.monthGan,zhi:e.monthZhi,nayin:C(e.month)},{gan:e.dayGan,zhi:e.dayZhi,nayin:C(e.day)},{gan:e.hourGan,zhi:e.hourZhi,nayin:C(e.hour)}])}catch(e){console.error("Bazi calculation failed:",e),this.bazi=[{gan:"?",zhi:"?",nayin:""},{gan:"?",zhi:"?",nayin:""},{gan:"?",zhi:"?",nayin:""},{gan:"?",zhi:"?",nayin:""}],this.siZhuData=null}},calculateLiuShen(){if(this.liuShenGrid=[["","",""],["","",""],["","",""]],!this.bazi||this.bazi.length<3||!this.bazi[2].gan)return;const a=this.bazi[2].gan,e=D[a];if(void 0!==e)for(let l=0;l<6;l++){const a=(e+l)%6,[s,t]=x[l];this.$set(this.liuShenGrid[s],t,L[a])}else console.error("Unknown day gan:",a)},calculateShenSha(){if(this.siZhuData)try{const a={yearGan:this.siZhuData.yearGan,yearZhi:this.siZhuData.yearZhi,monthGan:this.siZhuData.monthGan,monthZhi:this.siZhuData.monthZhi,dayGan:this.siZhuData.dayGan,dayZhi:this.siZhuData.dayZhi,hourGan:this.siZhuData.hourGan,hourZhi:this.siZhuData.hourZhi},e=[];m.forEach((l=>{const s=y(l,a,"");s&&s.length>0&&s.forEach((a=>{e.push({name:a,val:l})}))}));const l=[];for(let s=0;s<e.length;s+=5)l.push(e.slice(s,s+5));this.shenshaRows=l}catch(a){console.error("ShenSha calculation failed:",a),this.shenshaRows=[]}else this.shenshaRows=[]},getElementChar(a,e){return this.inputGrid&&this.inputGrid[a]&&this.inputGrid[a][e]?this.inputGrid[a][e]:""},getCellDetails:(a,e)=>null,getLiuShen(a,e){return this.liuShenGrid&&this.liuShenGrid[a]&&this.liuShenGrid[a][e]?this.liuShenGrid[a][e]:""},getLiuShenClass:a=>({"é’é¾™":"liushen-qinglong","æœ±é›€":"liushen-zhuque","è…¾è›‡":"liushen-tengshe","å‹¾é™ˆ":"liushen-gouchen","ç™½è™":"liushen-baihu","ç„æ­¦":"liushen-xuanwu"}[a]||""),getWuxingClass:a=>({"ç”²":"wood","ä¹™":"wood","å¯…":"wood","å¯":"wood","æœ¨":"wood","ä¸™":"fire","ä¸":"fire","å·³":"fire","åˆ":"fire","ç«":"fire","æˆŠ":"earth","å·±":"earth","è¾°":"earth","æˆŒ":"earth","ä¸‘":"earth","æœª":"earth","åœŸ":"earth","åºš":"metal","è¾›":"metal","ç”³":"metal","é…‰":"metal","é‡‘":"metal","å£¬":"water","ç™¸":"water","äº¥":"water","å­":"water","æ°´":"water"}[a]||""),getXunKong(a){if(!a||a.length<2)return"";const e=a.charAt(0),l=a.charAt(1),s=["å­","ä¸‘","å¯…","å¯","è¾°","å·³","åˆ","æœª","ç”³","é…‰","æˆŒ","äº¥"],t=["ç”²","ä¹™","ä¸™","ä¸","æˆŠ","å·±","åºš","è¾›","å£¬","ç™¸"].indexOf(e),i=s.indexOf(l);if(-1===t||-1===i)return"";const n=(i-t+12)%12,u=(n-1+12)%12;return s[(n-2+12)%12]+s[u]},getNayinColor(a){if(!a)return"";const e=a.slice(-1);return this.getWuxingClass(e)},getWuxing(a,e){const l=this.getElementChar(a,e);return Z[l]||""},getLiuQin(a,e){if(0===a&&0===e)return"";return function(a,e){return a&&e?a===e?"å…„å¼Ÿ":G[e]===a?"çˆ¶æ¯":W[e]===a?"å®˜é¬¼":G[a]===e?"å­å­™":W[a]===e?"å¦»è´¢":"":""}(this.getWuxing(0,0),this.getWuxing(a,e))}}},[["render",function(a,e,l,_,S,b){const p=f,m=i;return n(),s(m,{class:"container"},{default:t((()=>[u(m,{class:"nav-bar"},{default:t((()=>[u(m,{class:"left-actions"},{default:t((()=>[u(m,{class:"back-btn",onClick:b.goBack},{default:t((()=>[u(p,{class:"back-icon"},{default:t((()=>[r("â†")])),_:1}),u(p,{class:"back-text"},{default:t((()=>[r("è¿”å›")])),_:1})])),_:1},8,["onClick"])])),_:1}),u(p,{class:"nav-title"},{default:t((()=>[r("äº”å…†åœ")])),_:1}),u(m,{class:"nav-buttons"})])),_:1}),u(m,{class:"info-card"},{default:t((()=>[u(m,{class:"date-section"},{default:t((()=>[u(m,{class:"date-row"},{default:t((()=>[u(p,{class:"label"},{default:t((()=>[r("å…¬å†ï¼š")])),_:1}),u(p,{class:"value"},{default:t((()=>[r(h(S.solarDateStr),1)])),_:1})])),_:1}),u(m,{class:"date-row"},{default:t((()=>[u(p,{class:"label"},{default:t((()=>[r("å†œå†ï¼š")])),_:1}),u(p,{class:"value lunar"},{default:t((()=>[r(h(S.lunarDateStr),1)])),_:1})])),_:1})])),_:1}),u(m,{class:"bazi-grid"},{default:t((()=>[u(m,{class:"bazi-row header-row"},{default:t((()=>[u(m,{class:"bazi-cell header-cell"},{default:t((()=>[u(p,null,{default:t((()=>[r("å¹´")])),_:1})])),_:1}),u(m,{class:"bazi-cell header-cell"},{default:t((()=>[u(p,null,{default:t((()=>[r("æœˆ")])),_:1})])),_:1}),u(m,{class:"bazi-cell header-cell"},{default:t((()=>[u(p,null,{default:t((()=>[r("æ—¥")])),_:1})])),_:1}),u(m,{class:"bazi-cell header-cell"},{default:t((()=>[u(p,null,{default:t((()=>[r("æ—¶")])),_:1})])),_:1})])),_:1}),u(m,{class:"bazi-row"},{default:t((()=>[(n(!0),c(g,null,d(S.bazi,((a,e)=>(n(),s(m,{class:"bazi-cell",key:"gz-"+e},{default:t((()=>[u(p,{class:o(b.getWuxingClass(a.gan))},{default:t((()=>[r(h(a.gan),1)])),_:2},1032,["class"]),u(p,{class:o(b.getWuxingClass(a.zhi))},{default:t((()=>[r(h(a.zhi),1)])),_:2},1032,["class"])])),_:2},1024)))),128))])),_:1}),u(m,{class:"bazi-row"},{default:t((()=>[(n(!0),c(g,null,d(S.bazi,((a,e)=>(n(),s(m,{class:"bazi-cell",key:"xk-"+e},{default:t((()=>[(n(!0),c(g,null,d(b.getXunKong(a.gan+a.zhi).split(""),((a,e)=>(n(),s(p,{key:e,class:o(b.getWuxingClass(a))},{default:t((()=>[r(h(a),1)])),_:2},1032,["class"])))),128))])),_:2},1024)))),128))])),_:1}),u(m,{class:"bazi-row"},{default:t((()=>[(n(!0),c(g,null,d(S.bazi,((a,e)=>(n(),s(p,{class:o(["bazi-cell",b.getNayinColor(a.nayin)]),key:"ny-"+e},{default:t((()=>[r(h(a.nayin),1)])),_:2},1032,["class"])))),128))])),_:1})])),_:1})])),_:1}),u(m,{class:"display-card"},{default:t((()=>[u(m,{class:"grid-display"},{default:t((()=>[u(m,{class:"grid-row"},{default:t((()=>[u(m,{class:"grid-cell"},{default:t((()=>[u(p,{class:o(["big-char",b.getWuxingClass(b.getElementChar(0,0))])},{default:t((()=>[r(h(b.getElementChar(0,0)||"ç©º"),1)])),_:1},8,["class"]),u(p,{class:o(["liushen-label",b.getLiuShenClass(b.getLiuShen(0,0))])},{default:t((()=>[r(h(b.getLiuShen(0,0)),1)])),_:1},8,["class"]),u(p,{class:"liuqin-label"},{default:t((()=>[r("å…†èº«")])),_:1})])),_:1}),u(m,{class:"grid-cell"},{default:t((()=>[u(p,{class:"wuxing-bg fire"},{default:t((()=>[r("ç«")])),_:1}),u(p,{class:o(["big-char",b.getWuxingClass(b.getElementChar(0,1))])},{default:t((()=>[r(h(b.getElementChar(0,1)||"ç©º"),1)])),_:1},8,["class"]),u(p,{class:o(["liushen-label",b.getLiuShenClass(b.getLiuShen(0,1))])},{default:t((()=>[r(h(b.getLiuShen(0,1)),1)])),_:1},8,["class"]),u(p,{class:"liuqin-label"},{default:t((()=>[r(h(b.getLiuQin(0,1)),1)])),_:1})])),_:1}),u(m,{class:"grid-cell empty-cell"})])),_:1}),u(m,{class:"grid-row"},{default:t((()=>[u(m,{class:"grid-cell"},{default:t((()=>[u(p,{class:"wuxing-bg wood"},{default:t((()=>[r("æœ¨")])),_:1}),u(p,{class:o(["big-char",b.getWuxingClass(b.getElementChar(1,0))])},{default:t((()=>[r(h(b.getElementChar(1,0)||"ç©º"),1)])),_:1},8,["class"]),u(p,{class:o(["liushen-label",b.getLiuShenClass(b.getLiuShen(1,0))])},{default:t((()=>[r(h(b.getLiuShen(1,0)),1)])),_:1},8,["class"]),u(p,{class:"liuqin-label"},{default:t((()=>[r(h(b.getLiuQin(1,0)),1)])),_:1})])),_:1}),u(m,{class:"grid-cell center-cell"},{default:t((()=>[u(p,{class:"wuxing-bg earth"},{default:t((()=>[r("åœŸ")])),_:1}),u(p,{class:o(["big-char",b.getWuxingClass(b.getElementChar(1,1))])},{default:t((()=>[r(h(b.getElementChar(1,1)||"ç©º"),1)])),_:1},8,["class"]),u(p,{class:o(["liushen-label",b.getLiuShenClass(b.getLiuShen(1,1))])},{default:t((()=>[r(h(b.getLiuShen(1,1)),1)])),_:1},8,["class"]),u(p,{class:"liuqin-label"},{default:t((()=>[r(h(b.getLiuQin(1,1)),1)])),_:1})])),_:1}),u(m,{class:"grid-cell"},{default:t((()=>[u(p,{class:"wuxing-bg metal"},{default:t((()=>[r("é‡‘")])),_:1}),u(p,{class:o(["big-char",b.getWuxingClass(b.getElementChar(1,2))])},{default:t((()=>[r(h(b.getElementChar(1,2)||"ç©º"),1)])),_:1},8,["class"]),u(p,{class:o(["liushen-label",b.getLiuShenClass(b.getLiuShen(1,2))])},{default:t((()=>[r(h(b.getLiuShen(1,2)),1)])),_:1},8,["class"]),u(p,{class:"liuqin-label"},{default:t((()=>[r(h(b.getLiuQin(1,2)),1)])),_:1})])),_:1})])),_:1}),u(m,{class:"grid-row"},{default:t((()=>[u(m,{class:"grid-cell empty-cell"}),u(m,{class:"grid-cell"},{default:t((()=>[u(p,{class:"wuxing-bg water"},{default:t((()=>[r("æ°´")])),_:1}),u(p,{class:o(["big-char",b.getWuxingClass(b.getElementChar(2,1))])},{default:t((()=>[r(h(b.getElementChar(2,1)||"ç©º"),1)])),_:1},8,["class"]),u(p,{class:o(["liushen-label",b.getLiuShenClass(b.getLiuShen(2,1))])},{default:t((()=>[r(h(b.getLiuShen(2,1)),1)])),_:1},8,["class"]),u(p,{class:"liuqin-label"},{default:t((()=>[r(h(b.getLiuQin(2,1)),1)])),_:1})])),_:1}),u(m,{class:"grid-cell empty-cell"})])),_:1})])),_:1})])),_:1}),u(m,{class:"shensha-card"},{default:t((()=>[u(m,{class:"section-title"},{default:t((()=>[r("ç¥ç…")])),_:1}),(n(!0),c(g,null,d(S.shenshaRows,((a,e)=>(n(),s(m,{class:"ss-row",key:e},{default:t((()=>[(n(!0),c(g,null,d(a,((a,e)=>(n(),s(m,{class:"ss-item",key:e},{default:t((()=>[u(p,{class:"ss-name"},{default:t((()=>[r(h(a.name),1)])),_:2},1024),u(p,{class:"ss-dash"},{default:t((()=>[r("-")])),_:1}),u(p,{class:"ss-val"},{default:t((()=>[r(h(a.val),1)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)))),128))])),_:1}),u(m,{class:"copyright-info"},{default:t((()=>[u(m,{class:"copyright-line"},{default:t((()=>[r("Â© Developer: æ™¯å· Â· Wechat: Im_JingChuang")])),_:1}),u(m,{class:"copyright-line"},{default:t((()=>[r("Â© Technical supporter: å¿æ ¸ Â· Wechat: qinghe4994")])),_:1}),u(m,{class:"copyright-line"},{default:t((()=>[r("Â© Server supporterï¼š ğŸç‡•ä¹ç§¦ğŸ WeChatï¼šaispidercc")])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-75a0cfdd"]]);export{E as default};
